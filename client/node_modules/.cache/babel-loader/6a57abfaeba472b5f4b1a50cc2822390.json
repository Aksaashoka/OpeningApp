{"ast":null,"code":"var _jsxFileName = \"/home/alan/Escritorio/Integra/IntegraApp/src/components/Affiliate/Payment/PaymentButton.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport styles from './PaymentsTable.module.css';\nimport supabase from '../../../supabase.config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function PaymentButton({\n  product\n}) {\n  _s();\n\n  const [preferenceId, setPreferenceId] = useState(null);\n  useEffect(() => {\n    // luego de montarse el componente, le pedimos al backend el preferenceId\n    const getPreferenceId = async () => {\n      const res = await axios.post(`https://mercadopago-integra.herokuapp.com/api/orders`, {\n        userId: product.partner_dni,\n        productId: 3,\n        productName: product.concept,\n        productPrice: product.amount,\n        productQuantity: 1\n      });\n      setPreferenceId(res.data.preferenceId);\n    };\n\n    getPreferenceId(); //eslint-disable-next-line\n  }, []);\n  useEffect(() => {\n    if (preferenceId) {\n      // con el preferenceId en mano, inyectamos el script de mercadoPago\n      const script = document.createElement('script');\n      script.type = 'text/javascript';\n      script.src = 'https://www.mercadopago.com.ar/integrations/v1/web-payment-checkout.js';\n      script.setAttribute('data-preference-id', preferenceId);\n      const form = document.getElementById(product.id);\n      form.appendChild(script);\n\n      const updatePreferenceId = async () => {\n        await supabase.from('payments').update({\n          preference_id: preferenceId\n        }).eq('id', product.id);\n      };\n\n      updatePreferenceId();\n    } //eslint-disable-next-line\n\n  }, [preferenceId]);\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    id: product.id,\n    method: \"GET\",\n    className: styles.prueba\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 12\n  }, this);\n}\n\n_s(PaymentButton, \"7lmcCSk0T6yd8zua2nUPX8bguY8=\");\n\n_c = PaymentButton;\n\nvar _c;\n\n$RefreshReg$(_c, \"PaymentButton\");","map":{"version":3,"sources":["/home/alan/Escritorio/Integra/IntegraApp/src/components/Affiliate/Payment/PaymentButton.jsx"],"names":["React","useEffect","useState","axios","styles","supabase","PaymentButton","product","preferenceId","setPreferenceId","getPreferenceId","res","post","userId","partner_dni","productId","productName","concept","productPrice","amount","productQuantity","data","script","document","createElement","type","src","setAttribute","form","getElementById","id","appendChild","updatePreferenceId","from","update","preference_id","eq","prueba"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,4BAAnB;AACA,OAAOC,QAAP,MAAqB,0BAArB;;AAEA,eAAe,SAASC,aAAT,CAAuB;AAAEC,EAAAA;AAAF,CAAvB,EAAoC;AAAA;;AAC/C,QAAM,CAACC,YAAD,EAAeC,eAAf,IAAkCP,QAAQ,CAAC,IAAD,CAAhD;AAEAD,EAAAA,SAAS,CAAC,MAAM;AACZ;AAEA,UAAMS,eAAe,GAAG,YAAY;AAChC,YAAMC,GAAG,GAAG,MAAMR,KAAK,CAACS,IAAN,CACb,sDADa,EAEd;AACIC,QAAAA,MAAM,EAAEN,OAAO,CAACO,WADpB;AAEIC,QAAAA,SAAS,EAAE,CAFf;AAGIC,QAAAA,WAAW,EAAET,OAAO,CAACU,OAHzB;AAIIC,QAAAA,YAAY,EAAEX,OAAO,CAACY,MAJ1B;AAKIC,QAAAA,eAAe,EAAE;AALrB,OAFc,CAAlB;AAWAX,MAAAA,eAAe,CAACE,GAAG,CAACU,IAAJ,CAASb,YAAV,CAAf;AACH,KAbD;;AAeAE,IAAAA,eAAe,GAlBH,CAmBZ;AACH,GApBQ,EAoBN,EApBM,CAAT;AAsBAT,EAAAA,SAAS,CAAC,MAAM;AACZ,QAAIO,YAAJ,EAAkB;AACd;AACA,YAAMc,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;AACAF,MAAAA,MAAM,CAACG,IAAP,GAAc,iBAAd;AACAH,MAAAA,MAAM,CAACI,GAAP,GACI,wEADJ;AAEAJ,MAAAA,MAAM,CAACK,YAAP,CAAoB,oBAApB,EAA0CnB,YAA1C;AACA,YAAMoB,IAAI,GAAGL,QAAQ,CAACM,cAAT,CAAwBtB,OAAO,CAACuB,EAAhC,CAAb;AACAF,MAAAA,IAAI,CAACG,WAAL,CAAiBT,MAAjB;;AAEA,YAAMU,kBAAkB,GAAG,YAAY;AACnC,cAAM3B,QAAQ,CACT4B,IADC,CACI,UADJ,EAEDC,MAFC,CAEM;AAAEC,UAAAA,aAAa,EAAE3B;AAAjB,SAFN,EAGD4B,EAHC,CAGE,IAHF,EAGQ7B,OAAO,CAACuB,EAHhB,CAAN;AAIH,OALD;;AAOAE,MAAAA,kBAAkB;AACrB,KAnBW,CAoBZ;;AACH,GArBQ,EAqBN,CAACxB,YAAD,CArBM,CAAT;AAuBA,sBAAO;AAAM,IAAA,EAAE,EAAED,OAAO,CAACuB,EAAlB;AAAsB,IAAA,MAAM,EAAC,KAA7B;AAAmC,IAAA,SAAS,EAAE1B,MAAM,CAACiC;AAArD;AAAA;AAAA;AAAA;AAAA,UAAP;AACH;;GAjDuB/B,a;;KAAAA,a","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport styles from './PaymentsTable.module.css';\nimport supabase from '../../../supabase.config';\n\nexport default function PaymentButton({ product }) {\n    const [preferenceId, setPreferenceId] = useState(null);\n\n    useEffect(() => {\n        // luego de montarse el componente, le pedimos al backend el preferenceId\n\n        const getPreferenceId = async () => {\n            const res = await axios.post(\n                `https://mercadopago-integra.herokuapp.com/api/orders`,\n                {\n                    userId: product.partner_dni,\n                    productId: 3,\n                    productName: product.concept,\n                    productPrice: product.amount,\n                    productQuantity: 1,\n                }\n            );\n\n            setPreferenceId(res.data.preferenceId);\n        };\n\n        getPreferenceId();\n        //eslint-disable-next-line\n    }, []);\n\n    useEffect(() => {\n        if (preferenceId) {\n            // con el preferenceId en mano, inyectamos el script de mercadoPago\n            const script = document.createElement('script');\n            script.type = 'text/javascript';\n            script.src =\n                'https://www.mercadopago.com.ar/integrations/v1/web-payment-checkout.js';\n            script.setAttribute('data-preference-id', preferenceId);\n            const form = document.getElementById(product.id);\n            form.appendChild(script);\n\n            const updatePreferenceId = async () => {\n                await supabase\n                    .from('payments')\n                    .update({ preference_id: preferenceId })\n                    .eq('id', product.id);\n            };\n\n            updatePreferenceId();\n        }\n        //eslint-disable-next-line\n    }, [preferenceId]);\n\n    return <form id={product.id} method='GET' className={styles.prueba}/>;\n}\n"]},"metadata":{},"sourceType":"module"}