{"ast":null,"code":"var _jsxFileName = \"/home/alan/Escritorio/Integra/IntegraApp/src/components/Affiliate/UserFamilyMembers/FamilyStepper.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Stepper from \"@material-ui/core/Stepper\";\nimport Step from \"@material-ui/core/Step\";\nimport StepLabel from \"@material-ui/core/StepLabel\";\nimport Button from \"@material-ui/core/Button\";\nimport Typography from \"@material-ui/core/Typography\";\nimport DatosFamiliar from \"./DatosFamiliar\";\nimport DatosRevision from \"./DatosRevision\";\nimport supabase from \"../../../supabase.config\";\nimport style from \"./FamilyStepper.module.css\";\nimport Styles from \"../../Guest/ContactForm/ContactForm.module.css\";\nimport swal from \"sweetalert2\";\nimport Declaration from \"./Declaration\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    width: \"100%\"\n  },\n  backButton: {\n    marginRight: theme.spacing(1),\n    marginLeft: theme.spacing(5),\n    color: \"#fafafa\",\n    width: \"fit-content\",\n    border: \"3px solid #2c7f7b\",\n    borderRadius: \"5px\",\n    backgroundColor: \"#2c7f7b\",\n    fontWeight: \"bold\",\n    fontSize: \"15px\",\n    \"&:hover\": {\n      backgroundColor: \"#fafafa\",\n      color: \"#2c7f7b\"\n    }\n  },\n  instructions: {\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  popupBtn: {\n    color: \"#fafafa\",\n    width: \"fit-content\",\n    marginLeft: \"40px\",\n    border: \"3px solid #2c7f7b\",\n    borderRadius: \"5px\",\n    backgroundColor: \"#2c7f7b\",\n    fontWeight: \"bold\",\n    fontSize: \"15px\",\n    \"&:hover\": {\n      backgroundColor: \"#fafafa\",\n      color: \"#2c7f7b\"\n    }\n  }\n}));\n\nfunction getSteps() {\n  return [\"Datos del Familiar\", // 'Datos de la Empresa',\n  \"Antecedentes de Salud\", \"Resumen\"];\n}\n\nfunction getStepContent(stepIndex) {\n  switch (stepIndex) {\n    case 0:\n      return /*#__PURE__*/_jsxDEV(DatosFamiliar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 14\n      }, this);\n    // case 1:\n    //     return <DatosEmpresa />;\n\n    case 1:\n      return /*#__PURE__*/_jsxDEV(Declaration, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 14\n      }, this);\n    // case 3:\n    //   return <DatosFamiliares/>;\n\n    case 2:\n      return /*#__PURE__*/_jsxDEV(DatosRevision, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 14\n      }, this);\n\n    default:\n      return \"Unknown stepIndex\";\n  }\n}\n\nexport default function RegStepper() {\n  _s();\n\n  const classes = useStyles();\n  const [activeStep, setActiveStep] = useState(0);\n  const steps = getSteps();\n\n  const alltrue = obj => {\n    let completeError = true;\n\n    for (let error in obj) {\n      completeError = completeError && typeof Object.values(obj[error])[0] !== \"string\";\n    }\n\n    return completeError;\n  };\n\n  const handleNext = async () => {\n    switch (activeStep.toString()) {\n      case \"0\":\n        const errorsFamiliar = JSON.parse(localStorage.getItem(\"errorsFamiliar\"));\n\n        if (errorsFamiliar) {\n          alltrue(errorsFamiliar) ? setActiveStep(prevActiveStep => prevActiveStep + 1) : new swal(\"Ups!\", \"Debes completar todos los campos\");\n        } else new swal(\"Ups!\", \"Debes completar todos los campos\");\n\n        break;\n      // case '1':\n      //     const errorsEmpresa = JSON.parse(\n      //         localStorage.getItem('errorsEmpresa')\n      //     );\n      //     alltrue(errorsEmpresa)\n      //         ? setActiveStep((prevActiveStep) => prevActiveStep + 1)\n      //         : new swal('Ups!', 'Debes completar todos los campos');\n      //     break;\n\n      case \"1\":\n        const datosDeclaration = JSON.parse(localStorage.getItem(\"datosDeclaration\"));\n\n        if (datosDeclaration) {\n          if (datosDeclaration.accept) setActiveStep(prevActiveStep => prevActiveStep + 1);else new swal(\"Ups!\", \"Debe aceptar la declaracion Jurada\");\n        } else new swal(\"Ups!\", \"No se registraron datos\");\n\n        break;\n\n      default:\n        break;\n    } // setActiveStep((prevActiveStep) => prevActiveStep + 1)\n\n\n    if (activeStep === steps.length - 1) {\n      const datosFamiliar = JSON.parse(localStorage.getItem(\"datosFamiliar\")); // const datosEmpresa = JSON.parse(\n      //     localStorage.getItem('datosEmpresa')\n      // );\n\n      const datosDeclaration = JSON.parse(localStorage.getItem(\"datosDeclaration\"));\n      const affiliatedata = JSON.parse(localStorage.getItem(\"affiliatedata\")); // const { data: idPartners } = await supabase\n      //     .from('partners')\n      //     .select('family_group');\n      // const lastId =\n      //     idPartners\n      //         .sort(function (a, b) {\n      //             if (a.family_group < b.family_group) {\n      //                 return 1;\n      //             }\n      //             if (a.family_group > b.family_group) {\n      //                 return -1;\n      //             }\n      //             return 0;\n      //         })\n      //         .shift().family_group + 1;\n      // let idCompany = null;\n      // const { data: companyData } = await supabase\n      //     .from('companies')\n      //     .select('id')\n      //     .eq('cuit', datosEmpresa.company_cuit);\n      // console.log(companyData, 'companyData');\n      // if (companyData.length === 0) {\n      //     const { data: newId, error: errorInsertCompany } =\n      //         await supabase.from('companies').insert([\n      //             {\n      //                 business_name: datosEmpresa.bussines_name,\n      //                 cuit: datosEmpresa.company_cuit,\n      //                 phone_number: datosEmpresa.company_phone,\n      //                 email: datosEmpresa.company_email,\n      //             },\n      //         ]);\n      //     console.log(errorInsertCompany, 'errorInsertCompany');\n      //     console.log(newId, 'newId');\n      //     idCompany = newId[0].id;\n      // } else {\n      //     idCompany = companyData[0].id;\n      // }\n\n      const {\n        error: errorP\n      } = await supabase.from(\"partners\").insert([{\n        dni: datosFamiliar.dni,\n        name: datosFamiliar.first_name,\n        lastname: datosFamiliar.last_name,\n        birthdate: datosFamiliar.birth_date,\n        phone_number: datosFamiliar.phone_number,\n        titular: false,\n        family_bond: datosFamiliar.familyBond,\n        family_group: affiliatedata.family_group,\n        state: \"revision pendiente\",\n        email: datosFamiliar.email,\n        plan_id: affiliatedata.plan_id,\n        // // company_id: idCompany,\n        gender: datosFamiliar.gender\n      }]);\n\n      if (errorP) {\n        localStorage.removeItem(\"datosFamiliar\");\n        localStorage.removeItem(\"datosDeclaration\");\n        localStorage.removeItem(\"errorsFamiliar\");\n        setActiveStep(0);\n        return new swal(\"El DNI ya se encuentra Registrado\");\n      }\n\n      await supabase.from(\"address\").insert([{\n        street: datosFamiliar.street_name,\n        street_number: datosFamiliar.number,\n        floor: datosFamiliar.floor && datosFamiliar.floor,\n        locality_id: datosFamiliar.locality.split(\"-\")[0],\n        partner_dni: datosFamiliar.dni,\n        department: datosFamiliar.apartment && datosFamiliar.apartment\n      }]);\n      await supabase.from(\"medical_records\").insert([{\n        partner_dni: datosFamiliar.dni,\n        declaration: JSON.stringify(datosDeclaration)\n      }]);\n      localStorage.removeItem(\"datosFamiliar\");\n      localStorage.removeItem(\"datosDeclaration\");\n      localStorage.removeItem(\"errorsFamiliar\");\n      setActiveStep(prevActiveStep => prevActiveStep + 1);\n    }\n  };\n\n  const handleBack = () => {\n    setActiveStep(prevActiveStep => prevActiveStep - 1);\n  }; // const handleReset = () => {\n  //     setActiveStep(0);\n  //     localStorage.clear();\n  // };\n\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.root,\n    children: [/*#__PURE__*/_jsxDEV(Stepper, {\n      activeStep: activeStep,\n      alternativeLabel: true,\n      children: steps.map(label => /*#__PURE__*/_jsxDEV(Step, {\n        children: /*#__PURE__*/_jsxDEV(StepLabel, {\n          children: label\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 13\n        }, this)\n      }, label, false, {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: activeStep === steps.length ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: style.cartel,\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"../../assets/icons/medicrecordd.png\",\n            alt: \"medicRecord\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: style.text,\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: style.title,\n              children: \"Su Registro esta Completo\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 258,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n              className: style.subtitle,\n              children: \"Muchas gracias por su tiempo.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        classname: style.btn,\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          className: classes.instructions,\n          children: getStepContent(activeStep)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            disabled: activeStep === 0,\n            onClick: handleBack,\n            className: classes.backButton,\n            children: \"Back\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            className: classes.popupBtn,\n            variant: \"contained\",\n            color: \"primary\",\n            onClick: handleNext,\n            children: activeStep === 2 ? \"Finish\" : \"Next\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 240,\n    columnNumber: 5\n  }, this);\n}\n\n_s(RegStepper, \"5/ANSN4aidVPv0P4apAyeUUfwXQ=\", false, function () {\n  return [useStyles];\n});\n\n_c = RegStepper;\n\nvar _c;\n\n$RefreshReg$(_c, \"RegStepper\");","map":{"version":3,"sources":["/home/alan/Escritorio/Integra/IntegraApp/src/components/Affiliate/UserFamilyMembers/FamilyStepper.jsx"],"names":["React","useState","makeStyles","Stepper","Step","StepLabel","Button","Typography","DatosFamiliar","DatosRevision","supabase","style","Styles","swal","Declaration","useStyles","theme","root","width","backButton","marginRight","spacing","marginLeft","color","border","borderRadius","backgroundColor","fontWeight","fontSize","instructions","marginTop","marginBottom","popupBtn","getSteps","getStepContent","stepIndex","RegStepper","classes","activeStep","setActiveStep","steps","alltrue","obj","completeError","error","Object","values","handleNext","toString","errorsFamiliar","JSON","parse","localStorage","getItem","prevActiveStep","datosDeclaration","accept","length","datosFamiliar","affiliatedata","errorP","from","insert","dni","name","first_name","lastname","last_name","birthdate","birth_date","phone_number","titular","family_bond","familyBond","family_group","state","email","plan_id","gender","removeItem","street","street_name","street_number","number","floor","locality_id","locality","split","partner_dni","department","apartment","declaration","stringify","handleBack","map","label","cartel","text","title","subtitle","btn"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Stepper from \"@material-ui/core/Stepper\";\nimport Step from \"@material-ui/core/Step\";\nimport StepLabel from \"@material-ui/core/StepLabel\";\nimport Button from \"@material-ui/core/Button\";\nimport Typography from \"@material-ui/core/Typography\";\nimport DatosFamiliar from \"./DatosFamiliar\";\nimport DatosRevision from \"./DatosRevision\";\nimport supabase from \"../../../supabase.config\";\nimport style from \"./FamilyStepper.module.css\";\nimport Styles from \"../../Guest/ContactForm/ContactForm.module.css\";\nimport swal from \"sweetalert2\";\nimport Declaration from \"./Declaration\";\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    width: \"100%\",\n  },\n  backButton: {\n    marginRight: theme.spacing(1),\n    marginLeft: theme.spacing(5),\n    color: \"#fafafa\",\n    width: \"fit-content\",\n    border: \"3px solid #2c7f7b\",\n    borderRadius: \"5px\",\n    backgroundColor: \"#2c7f7b\",\n    fontWeight: \"bold\",\n    fontSize: \"15px\",\n    \"&:hover\": {\n      backgroundColor: \"#fafafa\",\n      color: \"#2c7f7b\",\n    },\n  },\n  instructions: {\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1),\n  },\n  popupBtn: {\n    color: \"#fafafa\",\n    width: \"fit-content\",\n    marginLeft: \"40px\",\n    border: \"3px solid #2c7f7b\",\n    borderRadius: \"5px\",\n    backgroundColor: \"#2c7f7b\",\n    fontWeight: \"bold\",\n    fontSize: \"15px\",\n    \"&:hover\": {\n      backgroundColor: \"#fafafa\",\n      color: \"#2c7f7b\",\n    },\n  },\n}));\n\nfunction getSteps() {\n  return [\n    \"Datos del Familiar\",\n    // 'Datos de la Empresa',\n    \"Antecedentes de Salud\",\n    \"Resumen\",\n  ];\n}\n\nfunction getStepContent(stepIndex) {\n  switch (stepIndex) {\n    case 0:\n      return <DatosFamiliar />;\n    // case 1:\n    //     return <DatosEmpresa />;\n    case 1:\n      return <Declaration />;\n    // case 3:\n    //   return <DatosFamiliares/>;\n    case 2:\n      return <DatosRevision />;\n    default:\n      return \"Unknown stepIndex\";\n  }\n}\n\nexport default function RegStepper() {\n  const classes = useStyles();\n  const [activeStep, setActiveStep] = useState(0);\n  const steps = getSteps();\n\n  const alltrue = (obj) => {\n    let completeError = true;\n    for (let error in obj) {\n      completeError =\n        completeError && typeof Object.values(obj[error])[0] !== \"string\";\n    }\n    return completeError;\n  };\n\n  const handleNext = async () => {\n    switch (activeStep.toString()) {\n      case \"0\":\n        const errorsFamiliar = JSON.parse(\n          localStorage.getItem(\"errorsFamiliar\")\n        );\n        if (errorsFamiliar) {\n          alltrue(errorsFamiliar)\n            ? setActiveStep((prevActiveStep) => prevActiveStep + 1)\n            : new swal(\"Ups!\", \"Debes completar todos los campos\");\n        } else new swal(\"Ups!\", \"Debes completar todos los campos\");\n        break;\n      // case '1':\n      //     const errorsEmpresa = JSON.parse(\n      //         localStorage.getItem('errorsEmpresa')\n      //     );\n      //     alltrue(errorsEmpresa)\n      //         ? setActiveStep((prevActiveStep) => prevActiveStep + 1)\n      //         : new swal('Ups!', 'Debes completar todos los campos');\n      //     break;\n      case \"1\":\n        const datosDeclaration = JSON.parse(\n          localStorage.getItem(\"datosDeclaration\")\n        );\n        if (datosDeclaration) {\n          if (datosDeclaration.accept)\n            setActiveStep((prevActiveStep) => prevActiveStep + 1);\n          else new swal(\"Ups!\", \"Debe aceptar la declaracion Jurada\");\n        } else new swal(\"Ups!\", \"No se registraron datos\");\n        break;\n\n      default:\n        break;\n    }\n    // setActiveStep((prevActiveStep) => prevActiveStep + 1)\n\n    if (activeStep === steps.length - 1) {\n      const datosFamiliar = JSON.parse(localStorage.getItem(\"datosFamiliar\"));\n      // const datosEmpresa = JSON.parse(\n      //     localStorage.getItem('datosEmpresa')\n      // );\n      const datosDeclaration = JSON.parse(\n        localStorage.getItem(\"datosDeclaration\")\n      );\n      const affiliatedata = JSON.parse(localStorage.getItem(\"affiliatedata\"));\n\n      // const { data: idPartners } = await supabase\n      //     .from('partners')\n      //     .select('family_group');\n\n      // const lastId =\n      //     idPartners\n      //         .sort(function (a, b) {\n      //             if (a.family_group < b.family_group) {\n      //                 return 1;\n      //             }\n      //             if (a.family_group > b.family_group) {\n      //                 return -1;\n      //             }\n      //             return 0;\n      //         })\n      //         .shift().family_group + 1;\n\n      // let idCompany = null;\n\n      // const { data: companyData } = await supabase\n      //     .from('companies')\n      //     .select('id')\n      //     .eq('cuit', datosEmpresa.company_cuit);\n      // console.log(companyData, 'companyData');\n\n      // if (companyData.length === 0) {\n      //     const { data: newId, error: errorInsertCompany } =\n      //         await supabase.from('companies').insert([\n      //             {\n      //                 business_name: datosEmpresa.bussines_name,\n      //                 cuit: datosEmpresa.company_cuit,\n      //                 phone_number: datosEmpresa.company_phone,\n      //                 email: datosEmpresa.company_email,\n      //             },\n      //         ]);\n      //     console.log(errorInsertCompany, 'errorInsertCompany');\n      //     console.log(newId, 'newId');\n\n      //     idCompany = newId[0].id;\n      // } else {\n      //     idCompany = companyData[0].id;\n      // }\n      const { error: errorP } = await supabase.from(\"partners\").insert([\n        {\n          dni: datosFamiliar.dni,\n          name: datosFamiliar.first_name,\n          lastname: datosFamiliar.last_name,\n          birthdate: datosFamiliar.birth_date,\n          phone_number: datosFamiliar.phone_number,\n          titular: false,\n          family_bond: datosFamiliar.familyBond,\n          family_group: affiliatedata.family_group,\n          state: \"revision pendiente\",\n          email: datosFamiliar.email,\n          plan_id: affiliatedata.plan_id,\n          // // company_id: idCompany,\n          gender: datosFamiliar.gender,\n        },\n      ]);\n      if (errorP) {\n        localStorage.removeItem(\"datosFamiliar\");\n        localStorage.removeItem(\"datosDeclaration\");\n        localStorage.removeItem(\"errorsFamiliar\");\n        setActiveStep(0);\n        return new swal(\"El DNI ya se encuentra Registrado\");\n      }\n      await supabase.from(\"address\").insert([\n        {\n          street: datosFamiliar.street_name,\n          street_number: datosFamiliar.number,\n          floor: datosFamiliar.floor && datosFamiliar.floor,\n          locality_id: datosFamiliar.locality.split(\"-\")[0],\n          partner_dni: datosFamiliar.dni,\n          department: datosFamiliar.apartment && datosFamiliar.apartment,\n        },\n      ]);\n\n      await supabase.from(\"medical_records\").insert([\n        {\n          partner_dni: datosFamiliar.dni,\n          declaration: JSON.stringify(datosDeclaration),\n        },\n      ]);\n      localStorage.removeItem(\"datosFamiliar\");\n      localStorage.removeItem(\"datosDeclaration\");\n      localStorage.removeItem(\"errorsFamiliar\");\n      setActiveStep((prevActiveStep) => prevActiveStep + 1);\n    }\n  };\n\n  const handleBack = () => {\n    setActiveStep((prevActiveStep) => prevActiveStep - 1);\n  };\n\n  // const handleReset = () => {\n  //     setActiveStep(0);\n  //     localStorage.clear();\n  // };\n\n  return (\n    <div className={classes.root}>\n      <Stepper activeStep={activeStep} alternativeLabel>\n        {steps.map((label) => (\n          <Step key={label}>\n            <StepLabel>{label}</StepLabel>\n          </Step>\n        ))}\n      </Stepper>\n      <div>\n        {activeStep === steps.length ? (\n          <div>\n            <div className={style.cartel}>\n              <img\n                src=\"../../assets/icons/medicrecordd.png\"\n                alt=\"medicRecord\"\n              />\n\n              <div className={style.text}>\n                <h3 className={style.title}>Su Registro esta Completo</h3>\n\n                <h4 className={style.subtitle}>\n                  Muchas gracias por su tiempo.\n                </h4>\n              </div>\n            </div>\n\n            {/* <Button onClick={handleReset}>Reset</Button> */}\n          </div>\n        ) : (\n          <div classname={style.btn}>\n            <Typography className={classes.instructions}>\n              {getStepContent(activeStep)}\n            </Typography>\n            <div>\n              <Button\n                disabled={activeStep === 0}\n                onClick={handleBack}\n                className={classes.backButton}\n              >\n                Back\n              </Button>\n              <Button\n                className={classes.popupBtn}\n                variant=\"contained\"\n                color=\"primary\"\n                onClick={handleNext}\n              >\n                {activeStep === 2 ? \"Finish\" : \"Next\"}\n              </Button>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}